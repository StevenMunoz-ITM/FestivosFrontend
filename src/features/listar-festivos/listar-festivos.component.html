<div class="container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Festivos en Colombia</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="year-selector">
        <mat-form-field appearance="fill">
          <mat-label>Año</mat-label>
          <input 
            matInput 
            type="number" 
            [(ngModel)]="anio"
            placeholder="2023">
        </mat-form-field>
        
        <button 
          mat-raised-button 
          color="primary" 
          (click)="obtenerFestivos()"
          [disabled]="loading()">
          Obtener Festivos
        </button>
      </div>

      @if (loading()) {
        <div class="loading">
          <mat-spinner></mat-spinner>
        </div>
      }

      @if (festivos().length > 0 && !loading()) {
        <div class="table-container">
          <ngx-datatable
            class="material"
            [rows]="festivos()"
            [columnMode]="'force'"
            [headerHeight]="50"
            [footerHeight]="50"
            [rowHeight]="'auto'"
            [limit]="10"
            [scrollbarH]="true">
            
            <ngx-datatable-column name="Festivo" prop="nombre">
              <ng-template let-value="value" ngx-datatable-cell-template>
                {{ value }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Fecha">
              <ng-template let-row="row" ngx-datatable-cell-template>
                @if (row.dia && row.mes) {
                  {{ row.dia }}/{{ row.mes }}/{{ anio() }}
                } @else {
                  Fecha variable
                }
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column name="Tipo" prop="tipo.tipo">
              <ng-template let-value="value" ngx-datatable-cell-template>
                {{ value || 'N/A' }}
              </ng-template>
            </ngx-datatable-column>

          </ngx-datatable>
          
          <p class="total-festivos">{{ festivos().length }} festivos encontrados</p>
        </div>
      }

      @if (festivos().length === 0 && !loading()) {
        <div class="no-data">
          <p>Selecciona un año y presiona "Obtener Festivos"</p>
        </div>
      }
    </mat-card-content>
    
    <mat-card-actions>
      <button mat-button color="accent" routerLink="/inicio">Volver</button>
    </mat-card-actions>
  </mat-card>
</div>
